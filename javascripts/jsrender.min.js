window.JsViews||window.jQuery&&jQuery.views||(function(window,undefined){var $,_$,JsViews,viewsNs,tmplEncode,render,rTag,registerTags,registerHelpers,extend,FALSE=false,TRUE=true,jQuery=window.jQuery,document=window.document,htmlExpr=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,rPath=/^(true|false|null|[\d\.]+)|(\w+|\$(view|data|ctx|(\w+)))([\w\.]*)|((['"])(?:\\\1|.)*\7)$/g,rParams=/(\$?[\w\.\[\]]+)(?:(\()|\s*(===|!==|==|!=|<|>|<=|>=)\s*|\s*(\=)\s*)?|(\,\s*)|\\?(\')|\\?(\")|(\))|(\s+)/g,rNewLine=/\r?\n/g,rUnescapeQuotes=/\\(['"])/g,rEscapeQuotes=/\\?(['"])/g,rBuildHash=/\x08([^\x08]+)\x08/g,autoName=0,escapeMapForHtml={"&":"&amp;","<":"&lt;",">":"&gt;"},htmlSpecialChar=/[\x00"&'<>]/g,slice=Array.prototype.slice;if(jQuery){$=jQuery;$.fn.extend({render:function(data,context,parentView,path){return render(data,this[0],context,parentView,path)},template:function(name,context){return $.template(name,this[0],context)}})}else{_$=window.$;window.JsViews=JsViews=window.$=$={extend:function(target,source){var name;for(name in source){target[name]=source[name]}return target},isArray:Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"},noConflict:function(){if(window.$===JsViews){window.$=_$}return JsViews}}}extend=$.extend;function View(context,path,parentView,data,template){parentView=parentView||{viewsCount:0,ctx:viewsNs.helpers};var parentContext=parentView&&parentView.ctx;return{jsViews:"v1.0pre",path:path||"",itemNumber:++parentView.viewsCount||1,viewsCount:0,tmpl:template,data:data||parentView.data||{},ctx:context&&context===parentContext?parentContext:(parentContext?extend(extend({},parentContext),context):context||{}),parent:parentView}}extend($,{views:viewsNs={templates:{},tags:{"if":function(){var ifTag=this,view=ifTag._view;view.onElse=function(presenter,args){var i=0,l=args.length;while(l&&!args[i++]){if(i===l){return""}}view.onElse=undefined;return render(view.data,presenter.tmpl,view.ctx,view)};return view.onElse(this,arguments)},"else":function(){var view=this._view;return view.onElse?view.onElse(this,arguments):""},each:function(){var i,self=this,result="",args=arguments,l=args.length,content=self.tmpl,view=self._view;for(i=0;i<l;i++){result+=args[i]?render(args[i],content,self.ctx||view.ctx,view,self._path,self._ctor):""}return l?result:result+render(view.data,content,view.ctx,view,self._path,self.tag)},"=":function(value){return value},"*":function(value){return value}},helpers:{not:function(value){return!value}},allowCode:FALSE,debugMode:TRUE,err:function(e){return viewsNs.debugMode?("<br/><b>Error:</b> <em> "+(e.message||e)+". </em>"):'""'},setDelimiters:function(openTag,closeTag){var firstCloseChar=closeTag.charAt(0),secondCloseChar=closeTag.charAt(1);openTag="\\"+openTag.charAt(0)+"\\"+openTag.charAt(1);closeTag="\\"+firstCloseChar+"\\"+secondCloseChar;rTag=openTag+"(?:(?:(\\#)?(\\w+(?=[!\\s\\"+firstCloseChar+"]))"+"|(?:(\\=)|(\\*)))"+"\\s*((?:[^\\"+firstCloseChar+"]|\\"+firstCloseChar+"(?!\\"+secondCloseChar+"))*?)"+"(!(\\w*))?"+"|(?:\\/([\\w\\$\\.\\[\\]]+)))"+closeTag;rTag=new RegExp(rTag,"g")},registerTags:registerTags=function(name,tagFn){var key;if(typeof name==="object"){for(key in name){registerTags(key,name[key])}}else{viewsNs.tags[name]=tagFn}return this},registerHelpers:registerHelpers=function(name,helper){if(typeof name==="object"){var key;for(key in name){registerHelpers(key,name[key])}}else{viewsNs.helpers[name]=helper}return this},encode:function(encoding,text){return text?(tmplEncode[encoding||"html"]||tmplEncode.html)(text):""},encoders:tmplEncode={"none":function(text){return text},"html":function(text){return String(text).replace(htmlSpecialChar,replacerForHtml)}},renderTag:function(tag,view,encode,content,tagProperties){var ret,ctx,name,args=arguments,presenters=viewsNs.presenters;hash=tagProperties._hash,tagFn=viewsNs.tags[tag];if(!tagFn){return""}content=content&&view.tmpl.nested[content-1];tagProperties.tmpl=tagProperties.tmpl||content||undefined;if(presenters&&presenters[tag]){ctx=extend(extend({},tagProperties.ctx),tagProperties);delete ctx.ctx;delete ctx._path;delete ctx.tmpl;tagProperties.ctx=ctx;tagProperties._ctor=tag+(hash?"="+hash.slice(0,-1):"");tagProperties=extend(extend({},tagFn),tagProperties);tagFn=viewsNs.tags.each}tagProperties._encode=encode;tagProperties._view=view;ret=tagFn.apply(tagProperties,args.length>5?slice.call(args,5):[view.data]);return ret||(ret===undefined?"":ret.toString())}},render:render=function(data,tmpl,context,parentView,path,tagName){var i,l,dataItem,arrayView,content,result="";if(arguments.length===2&&data.jsViews){parentView=data;context=parentView.ctx;data=parentView.data}tmpl=$.template(tmpl);if(!tmpl){return""}if($.isArray(data)){arrayView=new View(context,path,parentView,data);l=data.length;for(i=0,l=data.length;i<l;i++){dataItem=data[i];content=dataItem?tmpl(dataItem,new View(context,path,arrayView,dataItem,tmpl,this)):"";result+=viewsNs.activeViews?"<!--item-->"+content+"<!--/item-->":content}}else{result+=tmpl(data,new View(context,path,parentView,data,tmpl))}return viewsNs.activeViews?"<!--tmpl("+(path||"")+") "+(tagName?"tag="+tagName:tmpl._name)+"-->"+result+"<!--/tmpl-->":result},template:function(name,tmpl){if(tmpl){if(""+tmpl===tmpl){tmpl=compile(tmpl)}else if(jQuery&&tmpl instanceof $){tmpl=tmpl[0]}if(tmpl){if(jQuery&&tmpl.nodeType){tmpl=$.data(tmpl,"tmpl")||$.data(tmpl,"tmpl",compile(tmpl.innerHTML))}viewsNs.templates[tmpl._name=tmpl._name||name||"_"+autoName++]=tmpl}return tmpl}return name?""+name!==name?(name._name?name:$.template(null,name)):viewsNs.templates[name]||$.template(null,htmlExpr.test(name)?name:try$(name)):null}});viewsNs.setDelimiters("{{","}}");function parsePath(all,comp,object,viewDataCtx,viewProperty,path,string,quot){return object?((viewDataCtx?viewProperty?("$view."+viewProperty):object:("$data."+object))+(path||"")):string||(comp||"")}function compile(markup){var newNode,loc=0,stack=[],topNode=[],content=topNode,current=[,,topNode];function pushPreceedingContent(shift){shift-=loc;if(shift){content.push(markup.substr(loc,shift).replace(rNewLine,"\\n"))}}function parseTag(all,isBlock,tagName,equals,code,params,useEncode,encode,closeBlock,index){var named,hash="",parenDepth=0,quoted=FALSE,aposed=FALSE;function parseParams(all,path,paren,comp,eq,comma,apos,quot,rightParen,space,index){return aposed?(aposed=!apos,(aposed?all:'"')):quoted?(quoted=!quot,(quoted?all:'"')):comp?(path.replace(rPath,parsePath)+comp):eq?parenDepth?"":(named=TRUE,'\b'+path+':'):paren?(parenDepth++,path.replace(rPath,parsePath)+'('):rightParen?(parenDepth--,")"):path?path.replace(rPath,parsePath):comma?",":space?(parenDepth?"":named?(named=FALSE,"\b"):","):(aposed=apos,quoted=quot,'"')}tagName=tagName||equals;pushPreceedingContent(index);if(code){if(viewsNs.allowCode){content.push(["*",params.replace(rUnescapeQuotes,"$1")])}}else if(tagName){if(tagName==="else"){current=stack.pop();content=current[2];isBlock=TRUE}params=(params?(params+" ").replace(rParams,parseParams).replace(rBuildHash,function(all,keyValue,index){hash+=keyValue+",";return""}):"");params=params.slice(0,-1);newNode=[tagName,useEncode?encode||"none":"",isBlock&&[],"{"+hash+"_hash:'"+hash+"',_path:'"+params+"'}",params];if(isBlock){stack.push(current);current=newNode}content.push(newNode)}else if(closeBlock){current=stack.pop()}loc=index+all.length;if(!current){throw"Expected block tag"}content=current[2]}markup=markup.replace(rEscapeQuotes,"\\$1");markup.replace(rTag,parseTag);pushPreceedingContent(markup.length);return buildTmplFunction(topNode)}function buildTmplFunction(nodes){var ret,node,i,nested=[],l=nodes.length,code="try{var views="+(jQuery?"jQuery":"JsViews")+'.views,tag=views.renderTag,enc=views.encode,html=views.encoders.html,$ctx=$view && $view.ctx,result=""+\n\n';for(i=0;i<l;i++){node=nodes[i];if(node[0]==="*"){code=code.slice(0,i?-1:-3)+";"+node[1]+(i+1<l?"result+=":"")}else if(""+node===node){code+='"'+node+'"+'}else{var tag=node[0],encode=node[1],content=node[2],obj=node[3],params=node[4],paramsOrEmptyString=params+'||"")+';if(content){nested.push(buildTmplFunction(content))}code+=tag==="="?(!encode||encode==="html"?"html("+paramsOrEmptyString:encode==="none"?("("+paramsOrEmptyString):('enc("'+encode+'",'+paramsOrEmptyString)):'tag("'+tag+'",$view,"'+(encode||"")+'",'+(content?nested.length:'""')+","+obj+(params?",":"")+params+")+"}}ret=new Function("$data, $view",code.slice(0,-1)+";return result;\n\n}catch(e){return views.err(e);}");ret.nested=nested;return ret}function replacerForHtml(ch){return escapeMapForHtml[ch]||(escapeMapForHtml[ch]="&#"+ch.charCodeAt(0)+";")}function try$(selector){try{return $(selector)}catch(e){}return selector}})(window);